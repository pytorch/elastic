


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Elastic Launch &mdash; PyTorch/Elastic master documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="_static/pygments.css" type="text/css" /> -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0-beta/dist/katex.min.css" type="text/css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" type="text/css" />
  <link rel="stylesheet" href="_static/katex-math.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Elastic Agent" href="agent.html" />
    <link rel="prev" title="Examples" href="examples.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

  <!-- Preload the theme fonts -->

<link rel="preload" href="_static/fonts/FreightSans/freight-sans-book.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-medium-italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<!-- Preload the katex fonts -->

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://pytorch.org/" aria-label="PyTorch"></a>

      <div class="main-menu">
        <ul>
          <li>
            <a href="https://pytorch.org/get-started">Get Started</a>
          </li>

          <li>
            <div class="ecosystem-dropdown">
              <a id="dropdownMenuButton" data-toggle="ecosystem-dropdown">
                Ecosystem
              </a>
              <div class="ecosystem-dropdown-menu">
                <a class="nav-dropdown-item" href="https://pytorch.org/hub"">
                  <span class=dropdown-title>Models (Beta)</span>
                  <p>Discover, publish, and reuse pre-trained models</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/ecosystem">
                  <span class=dropdown-title>Tools & Libraries</span>
                  <p>Explore the ecosystem of tools and libraries</p>
                </a>
              </div>
            </div>
          </li>

          <li>
            <a href="https://pytorch.org/mobile">Mobile</a>
          </li>

          <li>
            <a href="https://pytorch.org/blog/">Blog</a>
          </li>

          <li>
            <a href="https://pytorch.org/tutorials">Tutorials</a>
          </li>

          <li>
            <a href="https://pytorch.org/docs/stable/index.html">Docs</a>
          </li>

          <li>
            <div class="resources-dropdown">
              <a id="resourcesDropdownButton" data-toggle="resources-dropdown">
                Resources
              </a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="https://pytorch.org/resources"">
                  <span class=dropdown-title>Developer Resources</span>
                  <p>Find resources and get questions answered</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/features">
                  <span class=dropdown-title>About</span>
                  <p>Learn about PyTorch’s features and capabilities</p>
                </a>
              </div>
            </div>
          </li>

          <li>
            <a href="https://github.com/pytorch/pytorch">Github</a>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>

  </div>
</div>


<body class="pytorch-body">

   

    

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
      <div class="pytorch-side-scroll">
        <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="pytorch-left-menu-search">
            

            
              
              
                <div class="version">
                  v0.2.1
                </div>
              
            

            


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

            
          </div>

          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Get Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="train_script.html">Train script</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Elastic Launch</a></li>
<li class="toctree-l1"><a class="reference internal" href="agent.html">Elastic Agent</a></li>
<li class="toctree-l1"><a class="reference internal" href="timer.html">Expiration Timers</a></li>
<li class="toctree-l1"><a class="reference internal" href="rendezvous.html">Rendezvous</a></li>
<li class="toctree-l1"><a class="reference internal" href="metrics.html">Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="events.html">Events</a></li>
</ul>
<p class="caption"><span class="caption-text">Advanced</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="customization.html">Customization</a></li>
</ul>
<p class="caption"><span class="caption-text">Plugins</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="kubernetes.html">TorchElastic Kubernetes</a></li>
<li class="toctree-l1"><a class="reference internal" href="runtime.html">Cloud Provider Support (Deprecated)</a></li>
</ul>
<p class="caption"><span class="caption-text">Experimental</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tsm_driver.html">Training Session Manager (TSM)</a></li>
<li class="toctree-l1"><a class="reference internal" href="multiprocessing.html">Multiprocessing</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <div class="pytorch-container">
      <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
        <div class="pytorch-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
      <li>Elastic Launch</li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
            
            <a href="_sources/distributed.rst.txt" rel="nofollow"><img src="_static/images/view-page-source-icon.svg"></a>
          
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
        <div class="pytorch-content-left">

        
          
          <div class="rst-content">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
              
  <div class="section" id="module-torchelastic.distributed">
<span id="elastic-launch"></span><span id="launcher-api"></span><h1>Elastic Launch<a class="headerlink" href="#module-torchelastic.distributed" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-torchelastic.distributed.launch">
<span id="elastic-launcher"></span><h2>Elastic launcher<a class="headerlink" href="#module-torchelastic.distributed.launch" title="Permalink to this headline">¶</a></h2>
<p>This module provides similar functionality as <code class="docutils literal notranslate"><span class="pre">torch.distributed.launch</span></code>,
with the following additional functionalities:</p>
<ol class="arabic simple">
<li><p>Worker failures are handled gracefully by restarting all workers.</p></li>
<li><p>Worker <code class="docutils literal notranslate"><span class="pre">RANK</span></code> and <code class="docutils literal notranslate"><span class="pre">WORLD_SIZE</span></code> are assigned automatically.</p></li>
<li><p>Number of nodes is allowed to change between min and max sizes (elasticity).</p></li>
</ol>
<p><strong>Usage:</strong></p>
<ol class="arabic simple">
<li><p>Single-node multi-worker (with sidecar etcd server)</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">torchelastic</span><span class="o">.</span><span class="n">distributed</span><span class="o">.</span><span class="n">launch</span>
<span class="go">    --standalone</span>
<span class="go">    --nnodes=1</span>
<span class="go">    --nproc_per_node=$NUM_TRAINERS</span>
<span class="go">    YOUR_TRAINING_SCRIPT.py (--arg1 ... train script args...)</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Fault tolerant (fixed sized number of workers, no elasticity).:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">torchelastic</span><span class="o">.</span><span class="n">distributed</span><span class="o">.</span><span class="n">launch</span>
<span class="go">    --nnodes=$NUM_NODES</span>
<span class="go">    --nproc_per_node=$NUM_TRAINERS</span>
<span class="go">    --rdzv_id=$JOB_ID</span>
<span class="go">    --rdzv_backend=etcd</span>
<span class="go">    --rdzv_endpoint=$ETCD_HOST:$ETCD_PORT</span>
<span class="go">    YOUR_TRAINING_SCRIPT.py (--arg1 ... train script args...)</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Elastic (<code class="docutils literal notranslate"><span class="pre">min=1</span></code>, <code class="docutils literal notranslate"><span class="pre">max=4</span></code>):</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">torchelastic</span><span class="o">.</span><span class="n">distributed</span><span class="o">.</span><span class="n">launch</span>
<span class="go">    --nnodes=1:4</span>
<span class="go">    --nproc_per_node=$NUM_TRAINERS</span>
<span class="go">    --rdzv_id=$JOB_ID</span>
<span class="go">    --rdzv_backend=etcd</span>
<span class="go">    --rdzv_endpoint=$ETCD_HOST:$ETCD_PORT</span>
<span class="go">    YOUR_TRAINING_SCRIPT.py (--arg1 ... train script args...)</span>
</pre></div>
</div>
<p><strong>Note on rendezvous backend</strong>:</p>
<p>For multi-node training you need to specify:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">--rdzv_id</span></code>: a unique job id (shared by all nodes participating in the job)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--rdzv_backend</span></code>: an implementation of <code class="docutils literal notranslate"><span class="pre">torchelastic.rendevous.RendezvousHandler</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--rdzv_endpoint</span></code>: <code class="docutils literal notranslate"><span class="pre">host:port</span></code>-style endpoint where the rdzv backend is running.</p></li>
</ol>
<p>Currently only <code class="docutils literal notranslate"><span class="pre">etcd</span></code> rdzv backend is supported out of the box.
To use <code class="docutils literal notranslate"><span class="pre">etcd</span></code>, setup an etcd server with the <code class="docutils literal notranslate"><span class="pre">v2</span></code> api enabled
(e.g. <code class="docutils literal notranslate"><span class="pre">--enable-v2</span></code>).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><code class="docutils literal notranslate"><span class="pre">EtcdRendezvous</span></code> uses etcd api v2. You MUST enable the v2
api on the etcd server. Our tests use etcd v3.4.3.</p>
</div>
<p><strong>Definitions:</strong></p>
<ol class="arabic simple">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">Node</span></code> - Physical instance or container.</dt><dd><p>Maps to the unit that the job manager works with.</p>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">Worker</span></code> - A worker in the context of distributed training.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Worker</span> <span class="pre">Group</span></code> - Workers that execute the same function (e.g. trainers)</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">Local</span> <span class="pre">Worker</span> <span class="pre">Group</span></code> - Subset of the workers in the</dt><dd><p>worker group running on the same Node</p>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">RANK</span></code> - rank of the worker within a worker group.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">WORLD_SIZE</span></code> - total number of workers in a worker group.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LOCAL_RANK</span></code> - rank of the worker within a local worker group</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LOCAL_WORLD_SIZE</span></code> - size of the local worker group</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">rdzv_id</span></code> - user defined id that uniquely identifies the worker group</dt><dd><p>for a job. This id is used by each node to join as a member of a particular
worker group.</p>
</dd>
</dl>
</li>
</ol>
<ol class="arabic simple" start="9">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">rdzv_backend</span></code> - the backend store of rendezvous (e.g. etcd). This is</dt><dd><p>typically a strongly consistent key-value store.</p>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">rdzv_endpoint</span></code> - rdzv backend server endpoint in <code class="docutils literal notranslate"><span class="pre">host:port</span></code> format.</p></li>
</ol>
<p>A <code class="docutils literal notranslate"><span class="pre">Node</span></code> runs <code class="docutils literal notranslate"><span class="pre">LOCAL_WORLD_SIZE</span></code> workers which comprise a <code class="docutils literal notranslate"><span class="pre">LocalWorkerGroup</span></code>.
The union of all <code class="docutils literal notranslate"><span class="pre">LocalWorkerGroups</span></code> in the nodes in the job comprise the
<code class="docutils literal notranslate"><span class="pre">WorkerGroup</span></code>.</p>
<p><strong>Environment Variables:</strong></p>
<p>The following environment variables are made available to you in your
script:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">LOCAL_RANK</span></code> -  local rank</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">RANK</span></code> -  global rank</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">GROUP_RANK</span></code> - rank of the worker group. A number between 0 - <code class="docutils literal notranslate"><span class="pre">max_nnodes</span></code>.</dt><dd><p>When running a single worker group per node, this is the rank of the node.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">ROLE_RANK</span></code> -  the rank of the worker across all the workers tha have the same</dt><dd><p>role. The role of the worker is specified in the <code class="docutils literal notranslate"><span class="pre">WorkerSpec</span></code>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">LOCAL_WORLD_SIZE</span></code> - local world size (e.g. number of workers running locally).</dt><dd><p>Equal to <code class="docutils literal notranslate"><span class="pre">--nproc_per_node</span></code> specified on <code class="docutils literal notranslate"><span class="pre">torchelastic.distributed.launch</span></code>.</p>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">WORLD_SIZE</span></code> - world size (total number of workers in the job).</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">ROLE_WORLD_SIZE</span></code> - the total number of workers that was launched with the same</dt><dd><p>role specified in <code class="docutils literal notranslate"><span class="pre">WorkerSpec</span></code>.</p>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">MASTER_ADDR</span></code> - fqdn of the host that is running worker with rank 0.
Used to initialize torch distributed backend.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MASTER_PORT</span></code> - port on the <code class="docutils literal notranslate"><span class="pre">MASTER_ADDR</span></code> that can be used to
host the tcp <code class="docutils literal notranslate"><span class="pre">c10d</span></code> store.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TORCHELASTIC_RESTART_COUNT</span></code> - number of worker group restarts so far.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TORCHELASTIC_MAX_RESTARTS</span></code> - configured max number of restarts.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TORCHELASTIC_RUN_ID</span></code> - equal to rdzv run_id (e.g. unique job id).</p></li>
</ol>
<p><strong>Deployment:</strong></p>
<ol class="arabic simple">
<li><p>Start the rdzv backend server and get the endpoint
(to be passed as <code class="docutils literal notranslate"><span class="pre">--rdzv_endpoint</span></code> to the launcher script)</p></li>
<li><p>Single-node multi-worker - start the launcher on the host to start
the agent process which creates and monitors a local worker group.</p></li>
<li><p>Multi-node multi-worker - Start the launcher with the same arguments
on all the nodes participating in training.</p></li>
</ol>
<p>When using a job/cluster manager the entry point command to the multi-node
job is invoking this launcher.</p>
<p><strong>Failure Modes:</strong></p>
<ol class="arabic simple">
<li><p>Worker failure - For a training job with <code class="docutils literal notranslate"><span class="pre">n</span></code> workers, if <code class="docutils literal notranslate"><span class="pre">k</span> <span class="pre">&lt;=</span> <span class="pre">n</span></code> workers fail
all workers are stopped and restarted up to <code class="docutils literal notranslate"><span class="pre">max_restarts</span></code>.</p></li>
<li><p>Agent failure - An agent failure results in local worker group failure,
it is up to the job manager to fail the entire job (gang semantics) or attempt
to replace the node. Both behaviors are supported by the agent.</p></li>
<li><p>Node failure - Same as agent failure.</p></li>
</ol>
<p><strong>Membership Changes:</strong></p>
<ol class="arabic simple">
<li><p>Node departure (scale-down) - agent is notified of the departure,
all existing workers are stopped, a new <code class="docutils literal notranslate"><span class="pre">Worker</span> <span class="pre">Group</span></code> is formed and all
workers are started with a new <code class="docutils literal notranslate"><span class="pre">RANK</span></code> and <code class="docutils literal notranslate"><span class="pre">WORLD_SIZE</span></code>.</p></li>
<li><p>Node arrival (scale-up) - the new node is admitted to the job,
all existing workers are stopped, a new <code class="docutils literal notranslate"><span class="pre">Worker</span> <span class="pre">Group</span></code> is formed and all
workers are started with a new <code class="docutils literal notranslate"><span class="pre">RANK</span></code> and <code class="docutils literal notranslate"><span class="pre">WORLD_SIZE</span></code>.</p></li>
</ol>
<p><strong>Important Notices:</strong></p>
<ol class="arabic simple">
<li><p>All the items in the important notices section of <code class="docutils literal notranslate"><span class="pre">torch.distributed.launch</span></code>
apply to this module as well</p></li>
<li><p>The environment variables necessary to initialize a torch process group
are provided to you by this module, no need for you to pass <code class="docutils literal notranslate"><span class="pre">RANK</span></code> manually.
To initialize a process group in your training script, simply run</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch.distributed</span> <span class="k">as</span> <span class="nn">dist</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span><span class="o">.</span><span class="n">init_process_group</span><span class="p">(</span><span class="n">backend</span><span class="o">=</span><span class="s2">&quot;gloo|nccl&quot;</span><span class="p">)</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>On failures or membership changes ALL surviving workers are killed
immediately. Make sure to checkpoint your progress. The frequency of
checkpoints should depend on your job’s tolerance for lost work.</p></li>
<li><p>This module only supports homogeneous <code class="docutils literal notranslate"><span class="pre">LOCAL_WORLD_SIZE</span></code>. That is,
it is assumed that all nodes run the same number of local workers (per role).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">RANK</span></code> is NOT stable. Between restarts, the local workers on a node
can be assgined a different range of ranks than before. NEVER hard code
any assumptions about the stable-ness of ranks or some correlation between
<code class="docutils literal notranslate"><span class="pre">RANK</span></code> and <code class="docutils literal notranslate"><span class="pre">LOCAL_RANK</span></code>.</p></li>
<li><p>When using elasticity (<code class="docutils literal notranslate"><span class="pre">min_size</span> <span class="pre">!=</span> <span class="pre">max_size</span></code>) DO NOT hard code
assumptions about <code class="docutils literal notranslate"><span class="pre">WORLD_SIZE</span></code> as the world size can change as
nodes are allowed to leave and join.</p></li>
<li><p>It is recommended your script have the following structure</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
  <span class="n">load_checkpoint</span><span class="p">(</span><span class="n">checkpoint_path</span><span class="p">)</span>
  <span class="n">initialize</span><span class="p">()</span>
  <span class="n">train</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">train</span><span class="p">():</span>
  <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="nb">iter</span><span class="p">(</span><span class="n">dataset</span><span class="p">):</span>
    <span class="n">train_step</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">should_checkpoint</span><span class="p">:</span>
      <span class="n">save_checkpoint</span><span class="p">(</span><span class="n">checkpoint_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


             </article>
             
            </div>
            <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="agent.html" class="btn btn-neutral float-right" title="Elastic Agent" accesskey="n" rel="next">Next <img src="_static/images/chevron-right-orange.svg" class="next-page"></a>
      
      
        <a href="examples.html" class="btn btn-neutral" title="Examples" accesskey="p" rel="prev"><img src="_static/images/chevron-right-orange.svg" class="previous-page"> Previous</a>
      
    </div>
  

  

    <hr>

  

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, PyTorch Elastic Contributors.

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
     

</footer>

          </div>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">Elastic Launch</a><ul>
<li><a class="reference internal" href="#module-torchelastic.distributed.launch">Elastic launcher</a></li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
      </section>
    </div>

  


  

     
       <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
         <script src="_static/jquery.js"></script>
         <script src="_static/underscore.js"></script>
         <script src="_static/doctools.js"></script>
         <script src="_static/language_data.js"></script>
         <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"></script>
         <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js"></script>
         <script src="_static/katex_autorenderer.js"></script>
     

  

  <script type="text/javascript" src="_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="_static/js/vendor/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <!-- Begin Footer -->

  <div class="container-fluid docs-tutorials-resources" id="docs-tutorials-resources">
    <div class="container">
      <div class="row">
        <div class="col-md-4 text-center">
          <h2>Docs</h2>
          <p>Access comprehensive developer documentation for PyTorch</p>
          <a class="with-right-arrow" href="https://pytorch.org/docs/stable/index.html">View Docs</a>
        </div>

        <div class="col-md-4 text-center">
          <h2>Tutorials</h2>
          <p>Get in-depth tutorials for beginners and advanced developers</p>
          <a class="with-right-arrow" href="https://pytorch.org/tutorials">View Tutorials</a>
        </div>

        <div class="col-md-4 text-center">
          <h2>Resources</h2>
          <p>Find development resources and get your questions answered</p>
          <a class="with-right-arrow" href="https://pytorch.org/resources">View Resources</a>
        </div>
      </div>
    </div>
  </div>

  <footer class="site-footer">
    <div class="container footer-container">
      <div class="footer-logo-wrapper">
        <a href="https://pytorch.org/" class="footer-logo"></a>
      </div>

      <div class="footer-links-wrapper">
        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://pytorch.org/">PyTorch</a></li>
            <li><a href="https://pytorch.org/get-started">Get Started</a></li>
            <li><a href="https://pytorch.org/features">Features</a></li>
            <li><a href="https://pytorch.org/ecosystem">Ecosystem</a></li>
            <li><a href="https://pytorch.org/blog/">Blog</a></li>
            <li><a href="https://github.com/pytorch/pytorch/blob/master/CONTRIBUTING.md">Contributing</a></li>
          </ul>
        </div>

        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://pytorch.org/resources">Resources</a></li>
            <li><a href="https://pytorch.org/tutorials">Tutorials</a></li>
            <li><a href="https://pytorch.org/docs/stable/index.html">Docs</a></li>
            <li><a href="https://discuss.pytorch.org" target="_blank">Discuss</a></li>
            <li><a href="https://github.com/pytorch/pytorch/issues" target="_blank">Github Issues</a></li>
            <li><a href="https://pytorch.org/assets/brand-guidelines/PyTorch-Brand-Guidelines.pdf" target="_blank">Brand Guidelines</a></li>
          </ul>
        </div>

        <div class="footer-links-col follow-us-col">
          <ul>
            <li class="list-title">Stay Connected</li>
            <li>
              <div id="mc_embed_signup">
                <form
                  action="https://twitter.us14.list-manage.com/subscribe/post?u=75419c71fe0a935e53dfa4a3f&id=91d0dccd39"
                  method="post"
                  id="mc-embedded-subscribe-form"
                  name="mc-embedded-subscribe-form"
                  class="email-subscribe-form validate"
                  target="_blank"
                  novalidate>
                  <div id="mc_embed_signup_scroll" class="email-subscribe-form-fields-wrapper">
                    <div class="mc-field-group">
                      <label for="mce-EMAIL" style="display:none;">Email Address</label>
                      <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" placeholder="Email Address">
                    </div>

                    <div id="mce-responses" class="clear">
                      <div class="response" id="mce-error-response" style="display:none"></div>
                      <div class="response" id="mce-success-response" style="display:none"></div>
                    </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->

                    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_75419c71fe0a935e53dfa4a3f_91d0dccd39" tabindex="-1" value=""></div>

                    <div class="clear">
                      <input type="submit" value="" name="subscribe" id="mc-embedded-subscribe" class="button email-subscribe-button">
                    </div>
                  </div>
                </form>
              </div>

            </li>
          </ul>

          <div class="footer-social-icons">
            <a href="https://www.facebook.com/pytorch" target="_blank" class="facebook"></a>
            <a href="https://twitter.com/pytorch" target="_blank" class="twitter"></a>
            <a href="https://www.youtube.com/pytorch" target="_blank" class="youtube"></a>
          </div>
        </div>
      </div>
    </div>
  </footer>

  <div class="cookie-banner-wrapper">
  <div class="container">
    <p class="gdpr-notice">To analyze traffic and optimize your experience, we serve cookies on this site. By clicking or navigating, you agree to allow our usage of cookies. As the current maintainers of this site, Facebook’s Cookies Policy applies. Learn more, including about available controls: <a href="https://www.facebook.com/policies/cookies/">Cookies Policy</a>.</p>
    <img class="close-button" src="_static/images/pytorch-x.svg">
  </div>
</div>

  <!-- End Footer -->

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://pytorch.org/" aria-label="PyTorch"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="https://pytorch.org/get-started">Get Started</a>
          </li>

          <li>
            <a href="https://pytorch.org/features">Features</a>
          </li>

          <li>
            <a href="https://pytorch.org/ecosystem">Ecosystem</a>
          </li>

          <li>
            <a href="https://pytorch.org/mobile">Mobile</a>
          </li>

          <li>
            <a href="https://pytorch.org/hub">PyTorch Hub</a>
          </li>

          <li>
            <a href="https://pytorch.org/blog/">Blog</a>
          </li>

          <li>
            <a href="https://pytorch.org/tutorials">Tutorials</a>
          </li>

          <li>
            <a href="https://pytorch.org/docs/stable/index.html">Docs</a>
          </li>

          <li>
            <a href="https://pytorch.org/resources">Resources</a>
          </li>

          <li>
            <a href="https://github.com/pytorch/pytorch">Github</a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>